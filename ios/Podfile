# ملف Podfile مصحح خصيصاً لمشاريع Flutter على iOS في بيئات CI/CD مثل Codemagic.

# تعيين الحد الأدنى لإصدار iOS المطلوب.
platform :ios, '15.0'

# هذا الجزء ضروري لإيجاد ملف podhelper.rb في بيئة Codemagic
# ويمنع أخطاء المسار التي تحدث عند البناء.
flutter_root = ENV['FLUTTER_ROOT'] || '/Users/builder/programs/flutter'
raise "FLUTTER_ROOT not set or not found at #{flutter_root}" unless File.exist?(flutter_root)
load File.join(flutter_root, 'packages', 'flutter_tools', 'bin', 'podhelper.rb')

# استخدام `static` لمنع مشاكل Header Search Paths، وهي سبب خطأ "Flutter/Flutter.h not found".
# واستخدام `use_modular_headers!` لدمج مكتبات Swift/Objective-C بسلاسة.
use_frameworks! :linkage => :static
use_modular_headers!

target 'Runner' do
  # هذا السطر يقوم بتثبيت جميع المكتبات (Pods) التي يحتاجها مشروع Flutter تلقائياً.
  # هذا هو الحل الصحيح والوحيد لتجنب المشاكل المعقدة في الـ `post_install`.
  flutter_install_all_ios_pods File.dirname(File.realpath(__FILE__))
end
