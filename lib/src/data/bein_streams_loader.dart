import 'bein_streams_loader.dart';
import 'channel_logos.dart'; // تأكد هذا الملف يعرّف: Map<String, dynamic> channelLogos

/// ترتيب أسماء القنوات كما في مشروعك السابق:
const List<String> _orderedChannelNames = [
  'BEIN SPORTS XTRA1',
  'BEIN SPORTS XTRA2',
  'BEIN 1',
  'BEIN 2',
  'BEIN 3',
  'BEIN 4',
  'BEIN 5',
  'BEIN 6',
  'BEIN 7',
  'BEIN 8',
  'BEIN 9',
  'BEIN 1_F',
  'BEIN 2_F',
  'BEIN 3_F',
  'BEIN 4_F',
  'BEIN 5_F',
  'BEIN 6_F',
  'BEIN 7_F',
  'BEIN 8_F',
  'BEIN 9_F',
  'BEIN SPORTS 1 4K H265',
  'BEIN SPORTS 2 4K H265',
  'BEIN SPORTS 3 4K H265',
  'BEIN SPORTS 4 4K H265',
  'BEIN SPORTS 5 4K H265',
  'BEIN SPORTS 6 4K H265',
  'BEIN SPORTS 7 4K H265',
  'BEIN SPORTS 8 4K H265',
  'BEIN SPORTS 9 4K H265',
  'BEIN SPORTS 1 4K PURE',
  'BEIN SPORTS 2 4K PURE',
  'BEIN SPORTS 3 4K PURE',
  'BEIN SPORTS 4 4K PURE',
  'BEIN SPORTS 5 4K PURE',
  'BEIN SPORTS 6 4K PURE',
  'BEIN SPORTS 7 4K PURE',
  'BEIN SPORTS 8 4K PURE',
  'BEIN SPORTS 9 4K PURE',
  'FR: BEIN SPORTS 1',
  'FR: BEIN SPORTS 2',
  'FR: BEIN SPORTS 3',
  'FR: BEIN SPORT MAX 4',
  'FR: BEIN SPORT MAX 5',
  'FR: BEIN SPORT MAX 6',
  'FR: BEIN SPORT MAX 7',
  'FR: BEIN SPORT MAX 8',
  'FR: BEIN SPORT MAX 9',
  'SSC SPORT 1',
  'SSC SPORT 2',
  'SSC SPORT 3',
  'SSC SPORT 4',
  'SSC SPORT 5',
  'SSC SPORTS 1 HEVC',
  'SSC SPORTS 2 HEVC',
  'SSC SPORTS 3 HEVC',
  'SSC SPORTS 4 HEVC',
  'SSC SPORTS 5 HEVC',
  'SSC SPORT 1 LOW',
  'SSC SPORT 2 LOW',
  'SSC SPORT 3 LOW',
  'SSC SPORT 4 LOW',
  'SSC SPORT 5 LOW',
  'SSC SPORTS 1 4K',
  'SSC SPORTS 2 4K',
  'SSC SPORTS 3 4K',
  'SSC SPORTS 4 4K',
  'SSC SPORTS 5 4K',
  'SSC SPORT 1 VEGA',
  'SSC SPORT 2 VEGA',
  'SSC SPORT 3 VEGA',
  'SSC SPORT 4 VEGA',
  'SSC SPORT 5 VEGA',
  'BEIN SPORTS XTRA3',
  'BEIN AFC 1',
  'BEIN AFC 2',
  'BEIN AFC 3',
  'USA - BEIN SPORTS ENGLISH',
  'US: BEIN SPORTS',
  'US: (EN) BEIN SPORTS',
  'US: BEIN SPORTS XTRA',
  'BE: BEIN  TENNIS CHANNEL',
  'BE: BEIN STAR MOVIES',
  'BE: BEIN MOVIES 1 PREMIERE',
  'BE: BEIN MOVIES 2 ACTION',
  'BE: BEIN MOVIES 3 DRAMA',
  'BE: BEIN MOVIES 4 FAMILY',
  'BE: BEIN SERIES 1',
  'BE:  BEIN SERIES 2',
  'BE: BEIN FOX ACTION MOVIES',
  'BE: BEIN  FOX LIFE F',
  'BE: BEIN FOX MOVIES',
  'BE:  BEIN DISCOVERY ID',
  'BE: BEIN NATGEO WILD F',
  'BE: BEIN NATIONAL GEOGRAPHIC',
  'BE: BEIN ANIMAL PLANET',
  'BE: BEIN HGTV',
  'BE:  BEIN  FOX FAMILY MOVIES',
  'BE: BEIN  FATAFEAT',
  'BE: BEIN HISTORY 2',
  'BE: BEIN OUTDOOR',
  'BE: BEIN AMC',
  'BE: BEIN DTX',
  'BEIN STAR MOVIES',
  'BE: BEIN DRAMA 1',
  'BEIN JEEM',
  'BE: BEIN FOOD NETWORK',
  'BE: BEIN TRAVEL CHANNEL F',
  'BEIN: DREAMWORKS',
  '||FR|| BEIN SPORTS 2 F',
  '||FR|| BEIN SPORTS 3 F',
  '||FR|| BEIN MAX 4 F',
  '||FR|| BEIN MAX 6 F',
  '||FR|| BEIN MAX 5 F',
  '||FR|| BEIN MAX 7 F',
  '||FR|| BEIN MAX 8 F',
  '||FR|| BEIN MAX 9 F',
  '||FR|| BEIN MAX 4',
  '||FR|| BEIN MAX 5',
  '||FR|| BEIN MAX 6',
  '||FR|| BEIN MAX 7',
  '||FR|| BEIN MAX 10',
  '||FR|| BEIN SPORTS 1',
  '||FR|| BEIN SPORTS 2',
  '||FR|| BEIN SPORTS 3',
  'TR: BEIN MOVIES ACTION 2',
  'TR: BEIN MOVIES FAMILY F',
  'TR: BEIN MOVIES PREMIER 2 F',
  'TR: BEIN SPORTS 1',
  'TR: BEIN SPORTS 2',
  'TR: BEIN SPORTS 3',
  'TR: BEIN SPORTS 4',
  'TR: BEIN SPORTS HABER | TTNET',
  'TR: BEIN SPORTS MAX 1',
  'TR: BEIN SPORTS MAX 2',
];

/// يبني قائمة القنوات من كاش الفايربيس الحالي.
List<Map<String, dynamic>> buildBeinAndSscChannels(StreamsMap streamsMap) {
  return _orderedChannelNames.map((name) {
    final streams = streamsMap[name] ?? const <Map<String, dynamic>>[];
    return <String, dynamic>{
      'name': name,
      'logo': channelLogos[name], // لو ما عندك شعار لقناة، يرجع null
      'streams': streams,
    };
  }).toList();
}

/// نسخة ثابتة (تُقرأ من الكاش الحالي — قد تكون فارغة عند أول تشغيل حتى يكتمل fetch)
final List<Map<String, dynamic>> beinAndSscChannels =
    buildBeinAndSscChannels(BeinStreamsLoader.instance.cache);

/// ستريم حيّ — كل تحديث في Firestore ينعكس على القائمة مباشرة.
Stream<List<Map<String, dynamic>>> beinAndSscChannelsStream =
    BeinStreamsLoader.instance.watch().map(buildBeinAndSscChannels);
